library MyTestLib {
    unit caster;
    real casterX, casterY, spellX, spellY;
    integer i;

    function boom(real x, real y) {
        DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl", x, y));
    }

    function onInit() {        
        trigger t = CreateTrigger();
        for (0 <= i < bj_MAX_PLAYER_SLOTS) TriggerRegisterPlayerUnitEvent(t, Player(i), EVENT_PLAYER_UNIT_SPELL_EFFECT, null);
        TriggerAddAction(t, function() {
            real dx, dy, distance, angle, da;
            integer count = 50;
            //if (GetSpellAbilityId() != 'XXXX') return;
            caster = GetTriggerUnit();
            casterX = GetUnitX(caster);
            casterY = GetUnitY(caster);
            spellX = GetSpellTargetX();
            spellY = GetSpellTargetY();

            dx = spellX - casterX;
            dy = spellY - casterY;
    
            distance = SquareRoot(dx*dx + dy*dy);
            angle  = Atan2(dy, dx);
            da = 2 * bj_PI / I2R(count);
            
            for(0 <= i < count){
                boom(spellX, spellY);
                angle += da;
                spellX = casterX + distance * Cos(angle);
                spellY = casterY + distance * Sin(angle);
            }
        });

        t = null;
    }
 }